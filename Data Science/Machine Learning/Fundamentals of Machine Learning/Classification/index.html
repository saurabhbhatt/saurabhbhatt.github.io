



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.1, mkdocs-material-2.2.0">
    
    
      
        <title>Chapter 3: Classification - Machine Learning with Python</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.5d3fffba.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.fbd935c7.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    
      <body data-md-color-primary="indigo" data-md-color-accent="indigo">
    
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Machine Learning with Python" class="md-header-nav__button md-logo">
          
            <i class="md-icon">memory</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Machine Learning with Python
              </span>
              <span class="md-header-nav__topic">
                Chapter 3: Classification
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon">memory</i>
      
    </span>
    Machine Learning with Python
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Preface" class="md-nav__link">
      Preface
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Part 1: The Fundamentals of Machine Learning
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Part 1: The Fundamentals of Machine Learning
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Chapter 3: Classification
      </label>
    
    <a href="./" title="Chapter 3: Classification" class="md-nav__link md-nav__link--active">
      Chapter 3: Classification
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mnist-dataset" title="MNIST Dataset" class="md-nav__link">
    MNIST Dataset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-a-binary-classifier" title="Training a Binary Classifier" class="md-nav__link">
    Training a Binary Classifier
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-measure" title="Performance Measure" class="md-nav__link">
    Performance Measure
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#measuring-accuracy-using-cross-validation" title="Measuring Accuracy using Cross-Validation" class="md-nav__link">
    Measuring Accuracy using Cross-Validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#confusion-matrix" title="Confusion Matrix" class="md-nav__link">
    Confusion Matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#precision-and-recall" title="Precision and Recall" class="md-nav__link">
    Precision and Recall
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#precision-recall-tradeoff" title="Precision / Recall Tradeoff" class="md-nav__link">
    Precision / Recall Tradeoff
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-roc-curve" title="The RoC Curve" class="md-nav__link">
    The RoC Curve
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiclass-classification" title="Multiclass Classification" class="md-nav__link">
    Multiclass Classification
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-analysis" title="Error Analysis" class="md-nav__link">
    Error Analysis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multilabel-classification" title="Multilabel Classification" class="md-nav__link">
    Multilabel Classification
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multioutput-classification" title="Multioutput Classification" class="md-nav__link">
    Multioutput Classification
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise" title="Exercise" class="md-nav__link">
    Exercise
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#titanic-dataset" title="Titanic Dataset" class="md-nav__link">
    Titanic Dataset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spam-classifier" title="Spam Classifier" class="md-nav__link">
    Spam Classifier
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Training Models/" title="Chapter 4: Training Models" class="md-nav__link">
      Chapter 4: Training Models
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Support Vector Machines/" title="Chapter 5: Support Vector Machines" class="md-nav__link">
      Chapter 5: Support Vector Machines
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Part 2: Reinforcement Learning
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Part 2: Reinforcement Learning
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Reinforcement Learning/Basics/" title="Basics of Reinforcement Learning" class="md-nav__link">
      Basics of Reinforcement Learning
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Part 3: Time Series
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Part 3: Time Series
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Time Series/Basics of Time Series/" title="Basics of Time Series" class="md-nav__link">
      Basics of Time Series
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Part 4: Recommendation Engine
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Part 4: Recommendation Engine
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Recommendation Engine/Collaborative Filtering/" title="Collaborative Filtering" class="md-nav__link">
      Collaborative Filtering
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mnist-dataset" title="MNIST Dataset" class="md-nav__link">
    MNIST Dataset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-a-binary-classifier" title="Training a Binary Classifier" class="md-nav__link">
    Training a Binary Classifier
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-measure" title="Performance Measure" class="md-nav__link">
    Performance Measure
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#measuring-accuracy-using-cross-validation" title="Measuring Accuracy using Cross-Validation" class="md-nav__link">
    Measuring Accuracy using Cross-Validation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#confusion-matrix" title="Confusion Matrix" class="md-nav__link">
    Confusion Matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#precision-and-recall" title="Precision and Recall" class="md-nav__link">
    Precision and Recall
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#precision-recall-tradeoff" title="Precision / Recall Tradeoff" class="md-nav__link">
    Precision / Recall Tradeoff
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-roc-curve" title="The RoC Curve" class="md-nav__link">
    The RoC Curve
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiclass-classification" title="Multiclass Classification" class="md-nav__link">
    Multiclass Classification
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-analysis" title="Error Analysis" class="md-nav__link">
    Error Analysis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multilabel-classification" title="Multilabel Classification" class="md-nav__link">
    Multilabel Classification
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multioutput-classification" title="Multioutput Classification" class="md-nav__link">
    Multioutput Classification
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise" title="Exercise" class="md-nav__link">
    Exercise
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#titanic-dataset" title="Titanic Dataset" class="md-nav__link">
    Titanic Dataset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spam-classifier" title="Spam Classifier" class="md-nav__link">
    Spam Classifier
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="chapter-3-classification">Chapter 3: Classification</h1>
<p>We know that the most common supervised learning tasks are <strong>regression</strong> (predicting values) and <strong>classification</strong> (predicting classes). In regression, we can predict using various algorithms like Linear Regression, Decision Trees, Random Forest etc. In this chapter, we will figure out those algorithms which will be helpful in predicting classes. </p>
<h2 id="mnist-dataset">MNIST Dataset</h2>
<p>In this chapter, we will be using MNIST dataset. </p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_mldata</span>
<span class="n">mnist</span> <span class="o">=</span> <span class="n">fetch_mldata</span><span class="p">(</span><span class="s1">&#39;MNIST original&#39;</span><span class="p">)</span>
</pre></div>

<h2 id="training-a-binary-classifier">Training a Binary Classifier</h2>
<h2 id="performance-measure">Performance Measure</h2>
<p>Evaluating a classifer is often significantly trickier than evaluating a regressor. There are many performance measures are available. Let's see one by one.</p>
<h3 id="measuring-accuracy-using-cross-validation">Measuring Accuracy using Cross-Validation</h3>
<p>A good way to evaluate a model is by choosing the cross-validation.</p>
<p>(Add box wala thing)</p>
<div class="highlight"><pre><span></span><span class="c1"># Importing SGD Classifier from the library</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDClassifier</span>

<span class="c1"># Creating framework of model</span>
<span class="n">sgd_clf</span> <span class="o">=</span> <span class="n">SGDClassifier</span><span class="p">(</span><span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span><span class="p">)</span>

<span class="c1"># Fitting data in the model to obtain the parameters</span>
<span class="n">sgd_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train_5</span><span class="p">)</span>
</pre></div>

<p>Yes, we can see that most of the time the predictor is choosing 1. This is simply because anly about 10% of the data or images are 5s. It means if we always guess that the image is not 5. We will be true for about 90% of the time. Such data is also known as skewed dataset.</p>
<p>This is also one reason that the <code>accuracy</code> is generally not the preferred performance measure for classifiers, especially when we are dealing with <em>skewed datasets</em> (i.e., when some classes are much more frequent than others)</p>
<h3 id="confusion-matrix">Confusion Matrix</h3>
<h3 id="precision-and-recall">Precision and Recall</h3>
<h3 id="precision-recall-tradeoff">Precision / Recall Tradeoff</h3>
<h3 id="the-roc-curve">The RoC Curve</h3>
<h2 id="multiclass-classification">Multiclass Classification</h2>
<h2 id="error-analysis">Error Analysis</h2>
<h2 id="multilabel-classification">Multilabel Classification</h2>
<h2 id="multioutput-classification">Multioutput Classification</h2>
<h2 id="exercise">Exercise</h2>
<h3 id="titanic-dataset">Titanic Dataset</h3>
<h3 id="spam-classifier">Spam Classifier</h3>
<ul>
<li>Download Examples of </li>
</ul>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../.." title="Preface" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Preface
              </span>
            </div>
          </a>
        
        
          <a href="../Training Models/" title="Chapter 4: Training Models" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Chapter 4: Training Models
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 Saurabh Bhatt
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.6cdc17f0.js"></script>
      
      <script>app.initialize({version:"0.17.1",url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
    
  </body>
</html>